- job-template:
    name: ScaleIO-{check_name}
    description: "{description}"
    defaults: global
    parameters:
      - bool:
          name: CLEAN_ENV
          default: true
    scm:
      # remove this when OpenStack release new charms
      - emc-juju-scaleio
      - cs-juju-scaleio
      - jenkins-scripts
    builders:
      - shell: |
          #!/bin/bash -e
          {script}
    publishers:
      - archive:
          artifacts: 'logs/**'
          allow-empty: 'true'

- project:
   name: ScaleIO-checks
   check_name:
    - Juju-check-mdm-cluster:
       description: 'Deploys MDM service and checks cluster reconfiguration (using github/emccode charms) '
       script: './jenkins-scripts/juju/run-scaleio.sh scaleio/deploy-check-mdm-cluster.sh'
    - Juju-check-parameters:
       description: 'Deploys services and checks validity of config parameters (using github/emccode charms) '
       script: './jenkins-scripts/juju/run-scaleio.sh scaleio/deploy-check-parameters.sh'
    - Juju-check-GW-haproxy:
       description: 'Deploys ScaleIO cluster with cinder and keystone. Checks haproxy service of scaleio-gw. (using github/emccode charms) '
       script: './jenkins-scripts/juju/run-scaleio.sh scaleio-gw-haproxy/deploy-check-haproxy.sh'
   jobs:
    - 'ScaleIO-{check_name}'
