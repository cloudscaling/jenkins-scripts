- job:
    name: ScaleIO-OpenStack-dev
    description: "Deploys ScaleIO cluster(from bundle, from github) with OpenStack and checks it. Can be used for debug purposes."
    defaults: global
    parameters:
      - bool:
          name: CLEAN_ENV
          default: true
      - choice:
          name: VERSION
          description: "Version of the OpenStack"
          choices:
            - cloud:trusty-juno
            - cloud:trusty-kilo
            - cloud:trusty-liberty
    scm:
      - emc-juju-scaleio
      - cs-juju-scaleio
      - jenkins-scripts
    builders:
      - shell: |
          #!/bin/bash -e
          # while these charms are not in official repo - script copies them to one local juju repository
          for charm in cinder keystone nova-compute ; do
            cp -R juju-scaleio-tmp/trusty/$charm juju-scaleio/trusty/
          done
          export BUNDLE="bundles/openstack-scaleio-amazon.yaml"
          export BUNDLE_VERSION="cloud:trusty-kilo"
          ./jenkins-scripts/juju/run-scaleio-openstack.sh
